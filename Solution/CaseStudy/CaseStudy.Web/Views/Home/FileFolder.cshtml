@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}


<html>
<head>
    <title>File Upload with Fetch API</title>
</head>
<body>
    <form>
        <input type="file" id="fileInput" name="fileInput" multiple="multiple">
        <button type="button" id="uploadButton">Upload</button>
    </form>
    <script>
        const uploadButton = document.getElementById('uploadButton');
        const fileInput = document.getElementById('fileInput');
        const endpoint = 'https://localhost:7158/api/file/upload';
        uploadButton.addEventListener('click', () => {
            
            const formData = new FormData();

            for (var i = 0; i < fileInput.files.length; i++) { 
                formData.append('file' + i, fileInput.files[i]);
            }


                fetch(endpoint, {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer xxx'
                },
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    alert('File uploaded successfully!');
                })
                .catch(error => {
                    console.error(error);
                     // alert('Error uploading file');
                });
        });
    </script>
</body>
</html>